#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>

//Password check function
int verify_password(char *password, char *input_password)
{
    //0 is false, 1 is true
    char pass[0x10];
    int is_valid = 0;

    //copy the password before comparision
    //https://www.google.com/search?q=copy+string+in+C
    strcpy(pass, input_password);

    //if password match, set valid to true
    if(!strcmp(pass, password)){
        is_valid = 1;
    }

    return is_valid;
}

int main()
{
    char username[0x20];
    char password[0x20];

    puts("Welcome to the top secret nuclear activation program");
    printf("Please enter your username: ");
    fflush(stdout);

    //Secure input, no overflow here
    int read_bytes = read(0, username, sizeof(username));

    username[read_bytes-1] = 0;

    printf("Welcome %s, Please enter your password to continue\n", username);
    printf("Password: ");
    fflush(stdout);

    read(0, password, sizeof(password));

    //Hardcoded password is a bad practice but we won't go into that

    if(verify_password("t0ps3cr3t_p4ssw0rd", password)){
        puts("Successfully Authenticated");
        puts("WIN");
        system("/bin/sh");
    }
    else puts("Authentication failed");
}
